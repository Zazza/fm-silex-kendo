/*
* Kendo UI Web v2012.3.1114 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-web-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
(function(e,i){function t(e){return e!==i}function n(e,i,t){return Math.max(Math.min(e,t),i)}function o(e,i){var t=e.children(b);return t.data("kendoWindow")||t.data("kendo"+i)}function r(i){return e(z).filter(function(){var t=e(this);return t.is(S)&&o(t,i).options.modal}).sort(function(i,t){return+e(i).css("zIndex")-+e(t).css("zIndex")})}function s(e,i){return function(){var e=this,t=e.wrapper,n=t[0].style,o=e.options;if(!o.isMaximized&&!o.isMinimized)return e.restoreOptions={width:n.width,height:n.height},t.find(_).hide().end().find(U).parent().hide().eq(0).before(c.action({name:"Restore"})),i.call(e),e}}function a(e){var i=this;i.owner=e,i._draggable=new h(e.wrapper,{filter:_,group:e.wrapper.id+"-resizing",dragstart:m(i.dragstart,i),drag:m(i.drag,i),dragend:m(i.dragend,i)})}function d(e){var i=this;i.owner=e,i._draggable=new h(e.wrapper,{filter:x,group:e.wrapper.id+"-moving",dragstart:m(i.dragstart,i),drag:m(i.drag,i),dragend:m(i.dragend,i),dragcancel:m(i.dragcancel,i)})}var c,l=window.kendo,p=l.ui.Widget,h=l.ui.Draggable,f=e.isPlainObject,m=e.proxy,u=e.extend,g=e.each,w=l.template,v="body",k=".kendoWindow",z=".k-window",y=".k-window-title",x=y+"bar",b=".k-window-content",_=".k-resize-handle",T=".k-overlay",W="k-content-frame",M="k-loading",H="k-state-hover",P="k-state-focused",S=":visible",C="hidden",O="cursor",D="open",F="activate",I="deactivate",R="close",L="refresh",A="resize",j="dragstart",q="dragend",N="error",E="overflow",G="zIndex",U=".k-window-actions .k-i-minimize,.k-window-actions .k-i-maximize",K=".k-window-titlebar .k-window-action",Q=l.isLocalUrl,B=p.extend({init:function(i,n){var o,r,s,h,u,w,v,_=this,T=!1;p.fn.init.call(_,i,n),n=_.options,i=_.element,u=n.content,_.appendTo=e(n.appendTo||document.body),_._animations(),u&&!f(u)&&(u=n.content={url:u}),i.parent().is(_.appendTo)||(i.is(S)?(r=i.offset(),T=!0):(s=i.css("visibility"),h=i.css("display"),i.css({visibility:C,display:""}),r=i.offset(),i.css({visibility:s,display:h}))),t(n.visible)||(n.visible=i.is(S)),o=_.wrapper=i.closest(z),i.is(".k-content")&&o[0]||(i.addClass("k-window-content k-content"),_._createWindow(i,n),o=_.wrapper=i.closest(z),_._dimensions()),r&&o.css({top:r.top,left:r.left}),u&&_.refresh(u),_.toFront(),w=o.children(b),_._tabindex(w),n.visible&&n.modal&&_._overlay(o.is(S)).css({opacity:.5}),o.on("mouseenter"+k,K,function(){e(this).addClass(H)}).on("mouseleave"+k,K,function(){e(this).removeClass(H)}).on("touchend"+k+" click"+k,K,m(_._windowActionHandler,_)),w.on("keydown"+k,m(_._keydown,_)).on("focus"+k,function(){o.addClass(P)}).on("blur"+k,function(){o.removeClass(P)}),n.resizable&&(o.on("dblclick"+k,x,m(_.toggleMaximization,_)),g("n e s w se sw ne nw".split(" "),function(e,i){o.append(c.resizeHandle(i))}),_.resizing=new a(_)),n.draggable&&(_.dragging=new d(_)),v=i.attr("id"),v&&(v+="_wnd_title",o.find(x).children(y).attr("id",v),w.attr({role:"dialog","aria-labelledby":v})),o.add(o.find(".k-resize-handle,.k-window-titlebar")).on("mousedown"+k,m(_.toFront,_)),_.touchScroller=l.touchScroller(i),_._resizeHandler=function(e){return _._onDocumentResize(e)},e(window).on("resize",_._resizeHandler),n.visible&&(_.trigger(D),_.trigger(F)),l.notify(_)},_dimensions:function(){var e=this,i=e.wrapper,t=e.element,n=e.options;e.title(n.title),n.width&&i.width(n.width),n.height&&i.height(n.height),g(["minWidth","minHeight","maxWidth","maxHeight"],function(e,i){var o=n[i];o&&1/0!=o&&t.css(i,o)}),n.visible||i.hide()},_animations:function(){var e=this.options;e.animation===!1&&(e.animation={open:{effects:{}},close:{hide:!0,effects:{}}})},setOptions:function(e){p.fn.setOptions.call(this,e),this._animations(),this._dimensions()},events:[D,F,I,R,L,A,j,q,N],options:{name:"Window",animation:{open:{effects:{zoom:{direction:"in"},fade:{direction:"in"}},duration:350},close:{effects:{zoom:{direction:"out",properties:{scale:.7}},fade:{direction:"out"}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:90,minHeight:50,maxWidth:1/0,maxHeight:1/0},_keydown:function(e){var i,t,o,r,s=this,a=s.options,d=l.keys,c=e.keyCode,p=s.wrapper,h=10;e.target==e.currentTarget&&(c==d.ESC&&s._close(!0),a.draggable&&!e.ctrlKey&&(i=p.offset(),c==d.UP?t=p.css("top",i.top-h):c==d.DOWN?t=p.css("top",i.top+h):c==d.LEFT?t=p.css("left",i.left-h):c==d.RIGHT&&(t=p.css("left",i.left+h))),a.resizable&&e.ctrlKey&&(c==d.UP?(t=!0,r=p.height()-h):c==d.DOWN&&(t=!0,r=p.height()+h),c==d.LEFT?(t=!0,o=p.width()-h):c==d.RIGHT&&(t=!0,o=p.width()+h),t&&p.css({width:n(o,a.minWidth,a.maxWidth),height:n(r,a.minHeight,a.maxHeight)})),t&&e.preventDefault())},_overlay:function(i){var t=this.appendTo.children(".k-overlay"),n=this.wrapper;return t.length||(t=e("<div class='k-overlay' />")),t.insertBefore(n[0]).toggle(i).css(G,parseInt(n.css(G),10)-1),t},_windowActionHandler:function(t){var n=e(t.target).closest(".k-window-action").find(".k-icon"),o=this;g({"k-i-close":function(){o._close(!0)},"k-i-maximize":o.maximize,"k-i-minimize":o.minimize,"k-i-restore":o.restore,"k-i-refresh":o.refresh},function(e,r){return n.hasClass(e)?(t.preventDefault(),r.call(o),!1):i})},center:function(){var i=this.wrapper,t=e(window);return i.css({left:t.scrollLeft()+Math.max(0,(t.width()-i.width())/2),top:t.scrollTop()+Math.max(0,(t.height()-i.height())/2)}),this},title:function(e){var i=this,t=i.wrapper,n=i.options,o=t.find(x),r=o.children(y),s=o.outerHeight();return arguments.length?(e===!1?(t.addClass("k-window-titleless"),o.remove()):(o.length||t.prepend(c.titlebar(u(c,n))),t.css("padding-top",s),o.css("margin-top",-s)),r.text(e),i):r.text()},content:function(e){var i=this.wrapper.children(b);return e?(i.html(e),this):i.html()},open:function(){var i,t=this,n=t.wrapper,o=t.options,r=o.animation.open,s=n.children(b),a=s.css(E);return t.trigger(D)||(t.toFront(),o.visible=!0,o.modal&&(i=t._overlay(!1),r.duration?i.kendoStop().kendoAnimate({effects:"fade:in",duration:r.duration}):i.css("opacity",.5).show()),n.is(S)||(s.css(E,C),n.show().kendoStop().kendoAnimate({effects:r.effects,duration:r.duration,complete:function(){t.element.focus(),t.trigger(F),s.css(E,a)}}))),o.isMaximized&&(t._documentScrollTop=e(document).scrollTop(),e("html, body").css(E,C)),t},_close:function(t){var n,s,a,d=this,c=d.wrapper,l=d.options,p=l.animation.open,h=l.animation.close;c.is(S)&&!d.trigger(R,{userTriggered:!!t})&&(l.visible=!1,n=r(l.name),s=l.modal&&1==n.length&&n[0]==d.wrapper[0],a=l.modal?d._overlay(!0):e(i),s?h.duration?a.kendoStop().kendoAnimate({effects:"fade:out",duration:h.duration,hide:!0}):a.hide():n.length&&o(n.eq(n.length-2),l.name)._overlay(!0),c.kendoStop().kendoAnimate({effects:h.effects||p.effects,reverse:h.reverse===!0,duration:h.duration,complete:function(){c.hide(),d.trigger(I)}})),d.options.isMaximized&&(e("html, body").css(E,""),d._documentScrollTop&&d._documentScrollTop>0&&e(document).scrollTop(d._documentScrollTop))},close:function(){return this._close(!1),this},toFront:function(){var i=this,t=i.wrapper,n=t[0],o=+t.css(G),r=o;return e(z).each(function(i,t){var r=e(t),s=r.css(G),a=r.find(b);isNaN(s)||(o=Math.max(+s,o)),t!=n&&a.find("> ."+W).length>0&&a.append(c.overlay)}),(10001==o||o>r)&&(t.css(G,o+2),i.element.find("> .k-overlay").remove()),i.element.focus(),i},toggleMaximization:function(){return this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var i=this,t=i.options,n=i.restoreOptions;if(t.isMaximized||t.isMinimized)return i.wrapper.css({position:"absolute",left:n.left,top:n.top,width:n.width,height:n.height}).find(".k-window-content,.k-resize-handle").show().end().find(".k-window-titlebar .k-i-restore").parent().remove().end().end().find(U).parent().show(),e("html, body").css(E,""),this._documentScrollTop&&this._documentScrollTop>0&&e(document).scrollTop(this._documentScrollTop),t.isMaximized=t.isMinimized=!1,i.trigger(A),i},maximize:s("maximize",function(){var i=this,t=i.wrapper,n=t.position();u(i.restoreOptions,{left:n.left,top:n.top}),t.css({left:0,top:0,position:"fixed"}),this._documentScrollTop=e(document).scrollTop(),e("html, body").css(E,C),i.options.isMaximized=!0,i._onDocumentResize()}),minimize:s("minimize",function(){var e=this;e.wrapper.css("height",""),e.element.hide(),e.options.isMinimized=!0}),_onDocumentResize:function(){var i=this,t=i.wrapper,n=e(window);i.options.isMaximized&&(t.css({width:n.width(),height:n.height()-parseInt(t.css("padding-top"),10)}),i.trigger(A))},refresh:function(i){var n,o,r,s=this,a=s.options,d=e(s.element);return f(i)||(i={url:i}),i=u({},a.content,i),o=t(a.iframe)?a.iframe:i.iframe,r=i.url,r?(t(o)||(o=!Q(r)),o?(n=d.find("."+W)[0],n?n.src=r||n.src:d.html(c.contentFrame(u({},a,{content:i}))),d.find("."+W).unbind("load"+k).on("load"+k,function(){s.trigger(L)})):s._ajaxRequest(i)):(i.template&&s.content(w(i.template)({})),s.trigger(L)),s},_ajaxRequest:function(e){var i=this,t=e.template,n=i.wrapper.find(".k-window-titlebar .k-i-refresh"),o=setTimeout(function(){n.addClass(M)},100);jQuery.ajax(u({type:"GET",dataType:"html",cache:!1,error:m(function(e,t){i.trigger(N,{status:t,xhr:e})},i),complete:function(){clearTimeout(o),n.removeClass(M)},success:m(function(e){t&&(e=w(t)(e||{})),i.element.html(e),i.trigger(L)},i)},e))},destroy:function(){var i,t,n=this;p.fn.destroy.call(n),l.destroy(n.wrapper),n.resizing&&n.resizing.destroy(),n.dragging&&n.dragging.destroy(),n.wrapper.remove().add(n.wrapper.find(".k-resize-handle,.k-window-titlebar")).off(k),e(window).off("resize",n._resizeHandler),i=r(),t=n.options.modal&&!i.length,t?n._overlay(!1).remove():i.length>0&&o(i.eq(i.length-2),n.options.name)._overlay(!0)},_createWindow:function(){var i,t,n=this,o=n.element,r=n.options,s=l.support.isRtl(o);r.scrollable===!1&&o.attr("style","overflow:hidden;"),r.iframe&&r.content&&o.html(c.contentFrame(r)),t=e(c.wrapper(r)),r.title!==!1&&t.append(c.titlebar(u(c,r))),i=o.find("iframe:not(.k-content)").map(function(){var e=this.getAttribute("src");return this.src="",e}),t.toggleClass("k-rtl",s).appendTo(n.appendTo).append(o).find("iframe:not(.k-content)").each(function(e){this.src=i[e]}),t.find(".k-window-title").css(s?"left":"right",t.find(".k-window-actions").outerWidth()+10),o.show()}});c={wrapper:w("<div class='k-widget k-window' />"),action:w("<a role='button' href='\\#' class='k-window-action k-link'><span role='presentation' class='k-icon k-i-#= name.toLowerCase() #'>#= name #</span></a>"),titlebar:w("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions'># for (var i = 0; i < actions.length; i++) { ##= action({ name: actions[i] }) ## } #</div></div>"),overlay:"<div class='k-overlay' />",contentFrame:w("<iframe frameborder='0' title='#= title #' class='"+W+"' "+"src='#= content.url #'>"+"This page requires frames in order to show content"+"</iframe>"),resizeHandle:w("<div class='k-resize-handle k-resize-#= data #'></div>")},a.prototype={dragstart:function(i){var t=this,n=t.owner,o=n.wrapper;t.elementPadding=parseInt(n.wrapper.css("padding-top"),10),t.initialCursorPosition=o.offset(),t.resizeDirection=i.currentTarget.prop("className").replace("k-resize-handle k-resize-",""),t.initialSize={width:o.width(),height:o.height()},t.containerOffset=n.appendTo.offset(),o.append(c.overlay).find(_).not(i.currentTarget).hide(),e(v).css(O,i.currentTarget.css(O))},drag:function(e){var i,t,o,r,s=this,a=s.owner,d=a.wrapper,c=a.options,l=s.resizeDirection,p=s.containerOffset,h=s.initialCursorPosition,f=s.initialSize,m=e.x.location,u=e.y.location;l.indexOf("e")>=0?(i=m-h.left,d.width(n(i,c.minWidth,c.maxWidth))):l.indexOf("w")>=0&&(r=h.left+f.width,i=n(r-m,c.minWidth,c.maxWidth),d.css({left:r-i-p.left,width:i})),l.indexOf("s")>=0?(t=u-h.top-s.elementPadding,d.height(n(t,c.minHeight,c.maxHeight))):l.indexOf("n")>=0&&(o=h.top+f.height,t=n(o-u,c.minHeight,c.maxHeight),d.css({top:o-t-p.top,height:t})),a.trigger(A)},dragend:function(i){var t=this,n=t.owner,o=n.wrapper;return o.find(T).remove().end().find(_).not(i.currentTarget).show(),e(v).css(O,""),n.touchScroller&&n.touchScroller.reset(),27==i.keyCode&&o.css(t.initialCursorPosition).css(t.initialSize),!1},destroy:function(){this._draggable.destroy()}},d.prototype={dragstart:function(i){var t=this.owner,n=t.element,o=n.find(".k-window-actions"),r=t.appendTo.offset();t.trigger(j),t.initialWindowPosition=t.wrapper.position(),t.startPosition={left:i.x.client-t.initialWindowPosition.left,top:i.y.client-t.initialWindowPosition.top},t.minLeftPosition=o.length>0?o.outerWidth()+parseInt(o.css("right"),10)-n.outerWidth():20-n.outerWidth(),t.minLeftPosition-=r.left,t.minTopPosition=-r.top,t.wrapper.append(c.overlay).find(_).hide(),e(v).css(O,i.currentTarget.css(O))},drag:function(i){var t=this.owner,n={left:Math.max(i.x.client-t.startPosition.left,t.minLeftPosition),top:Math.max(i.y.client-t.startPosition.top,t.minTopPosition)};e(t.wrapper).css(n)},_finishDrag:function(){var i=this.owner;i.wrapper.find(_).toggle(!i.options.isMinimized).end().find(T).remove(),e(v).css(O,"")},dragcancel:function(e){this._finishDrag(),e.currentTarget.closest(z).css(this.owner.initialWindowPosition)},dragend:function(){return this._finishDrag(),this.owner.trigger(q),!1},destroy:function(){this._draggable.destroy()}},l.ui.plugin(B)})(window.kendo.jQuery);