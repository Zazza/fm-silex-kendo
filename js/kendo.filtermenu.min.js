/*
* Kendo UI Web v2012.3.1114 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-web-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
(function(e){function t(l,s){l.filters&&(l.filters=e.grep(l.filters,function(e){return t(e,s),e.filters?e.filters.length:e.field!=s}))}function l(e){var t,l,s,a,i,r;if(e&&e.length)for(r=[],t=0,l=e.length;l>t;t++)s=e[t],i=s.text||s.value||s,a=null==s.value?s.text||s:s.value,r[t]={text:i,value:a};return r}var s=window.kendo,a=s.ui,i="kendoNumericTextBox",r="kendoDatePicker",n=e.proxy,o="kendoPopup",d=".kendoFilterMenu",f="Is equal to",u="Is not equal to",p=a.Widget,c='<div><div class="k-filter-help-text">#=messages.info#</div><label><input type="radio" data-#=ns#bind="checked: filters[0].value" value="true" name="filters[0].value"/>#=messages.isTrue#</label><label><input type="radio" data-#=ns#bind="checked: filters[0].value" value="false" name="filters[0].value"/>#=messages.isFalse#</label><button type="submit" class="k-button">#=messages.filter#</button><button type="reset" class="k-button">#=messages.clear#</button></div>',v='<div><div class="k-filter-help-text">#=messages.info#</div><select data-#=ns#bind="value: filters[0].operator" data-#=ns#role="dropdownlist">#for(var op in operators){#<option value="#=op#">#=operators[op]#</option>#}#</select>#if(values){#<select data-#=ns#bind="value:filters[0].value" data-#=ns#text-field="text" data-#=ns#value-field="value" data-#=ns#source=\'#=kendo.stringify(values).replace(/\'/g,"&\\#39;")#\' data-#=ns#role="dropdownlist" data-#=ns#option-label="#=messages.selectValue#"></select>#}else{#<input data-#=ns#bind="value:filters[0].value" class="k-textbox" type="text" data-#=ns#type="#=type#"/>#}##if(extra){#<select class="k-filter-and" data-#=ns#bind="value: logic" data-#=ns#role="dropdownlist"><option value="and">#=messages.and#</option><option value="or">#=messages.or#</option></select><select data-#=ns#bind="value: filters[1].operator" data-#=ns#role="dropdownlist">#for(var op in operators){#<option value="#=op#">#=operators[op]#</option>#}#</select>#if(values){#<select data-#=ns#bind="value:filters[1].value" data-#=ns#text-field="text" data-#=ns#value-field="value" data-#=ns#source=\'#=kendo.stringify(values).replace(/\'/g,"&\\#39;")#\' data-#=ns#role="dropdownlist" data-#=ns#option-label="#=messages.selectValue#"></select>#}else{#<input data-#=ns#bind="value: filters[1].value" class="k-textbox" type="text" data-#=ns#type="#=type#"/>#}##}#<button type="submit" class="k-button">#=messages.filter#</button><button type="reset" class="k-button">#=messages.clear#</button></div>',g=p.extend({init:function(t,a){var f,u,g,m=this,h="string";p.fn.init.call(m,t,a),g=a.operators||{},t=m.element,a=m.options,a.appendToElement?m.link=e():(f=t.addClass("k-filterable").find(".k-grid-filter"),f[0]||(f=t.prepend('<a class="k-grid-filter" href="#"><span class="k-icon k-filter"/></a>').find(".k-grid-filter")),f.attr("tabindex",-1).on("click"+d,n(m._click,m))),m._refreshHandler=n(m.refresh,m),m.dataSource=a.dataSource.bind("change",m._refreshHandler),m.field=a.field||t.attr(s.attr("field")),m.model=m.dataSource.reader.model,m._parse=function(e){return e+""},m.model&&m.model.fields&&(u=m.model.fields[m.field],u&&(h=u.type||"string",m._parse=n(u.parse,u))),a.values&&(h="enums"),g=g[h]||a.operators[h],m.form=e('<form class="k-filter-menu"/>').html(s.template("boolean"===h?c:v)({field:m.field,ns:s.ns,messages:a.messages,extra:a.extra,operators:g,type:h,values:l(a.values)})).on("keydown"+d,n(m._keydown,m)).on("submit"+d,n(m._submit,m)).on("reset"+d,n(m._reset,m)),a.appendToElement?(t.append(m.form),m.popup=m.element.closest(".k-popup").data(o)):(m.popup=m.form[o]({anchor:f,open:n(m._open,m),activate:n(m._activate,m),close:m.options.closeCallback}).data(o),m.link=f),m.form.find("["+s.attr("type")+"=number]").removeClass("k-textbox")[i]().end().find("["+s.attr("type")+"=date]").removeClass("k-textbox")[r](),m.refresh()},refresh:function(){var e=this,t=e.dataSource.filter()||{filters:[],logic:"and"};e.filterModel=s.observable({logic:"and",filters:[{field:e.field,operator:"eq",value:""},{field:e.field,operator:"eq",value:""}]}),s.bind(e.form.children().first(),e.filterModel),e._bind(t)?e.link.addClass("k-state-active"):e.link.removeClass("k-state-active")},destroy:function(){var e=this;p.fn.destroy.call(e),s.unbind(e.form),s.destroy(e.form),e.form.unbind(d),e.popup.destroy(),e.link.unbind(d),e.dataSource.unbind("change",e._refreshHandler)},_bind:function(e){var t,l,s,a,i=this,r=e.filters,n=!1,o=0,d=i.filterModel;for(t=0,l=r.length;l>t;t++)a=r[t],a.field==i.field?(d.set("logic",e.logic),s=d.filters[o],s||(d.filters.push({field:i.field}),s=d.filters[o]),s.set("value",i._parse(a.value)),s.set("operator",a.operator),o++,n=!0):a.filters&&(n=n||i._bind(a));return n},_merge:function(l){var s,a,i,r=this,n=l.logic||"and",o=l.filters,d=r.dataSource.filter()||{filters:[],logic:"and"};for(t(d,r.field),o=e.grep(o,function(e){return""!==e.value}),a=0,i=o.length;i>a;a++)s=o[a],s.value=r._parse(s.value);return o.length&&(d.filters.length?(l.filters=o,"and"!==d.logic&&(d.filters=[{logic:d.logic,filters:d.filters}],d.logic="and"),o.length>1?d.filters.push(l):d.filters.push(o[0])):(d.filters=o,d.logic=n)),d},filter:function(e){e=this._merge(e),e.filters.length&&this.dataSource.filter(e)},clear:function(){var t=this,l=t.dataSource.filter()||{filters:[]};l.filters=e.grep(l.filters,function(l){return l.filters?(l.filters=e.grep(l.filters,function(e){return e.field!=t.field}),l.filters.length):l.field!=t.field}),l.filters.length||(l=null),t.dataSource.filter(l)},_submit:function(e){var t=this;e.preventDefault(),t.filter(t.filterModel.toJSON()),t.popup.close()},_reset:function(){this.clear(),this.popup.close()},_click:function(e){e.preventDefault(),e.stopPropagation(),this.popup.toggle()},_open:function(){var t;e(".k-filter-menu").not(this.form).each(function(){t=e(this).data(o),t&&t.close()})},_activate:function(){this.form.find(":focusable:first").focus()},_keydown:function(e){e.keyCode==s.keys.ESC&&this.popup.close()},options:{name:"FilterMenu",extra:!0,appendToElement:!1,type:"string",operators:{string:{eq:f,neq:u,startswith:"Starts with",contains:"Contains",doesnotcontain:"Does not contain",endswith:"Ends with"},number:{eq:f,neq:u,gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"},date:{eq:f,neq:u,gte:"Is after or equal to",gt:"Is after",lte:"Is before or equal to",lt:"Is before"},enums:{eq:f,neq:u}},messages:{info:"Show items with value that:",isTrue:"is true",isFalse:"is false",filter:"Filter",clear:"Clear",and:"And",or:"Or",selectValue:"-Select value-"}}});a.plugin(g)})(window.kendo.jQuery);