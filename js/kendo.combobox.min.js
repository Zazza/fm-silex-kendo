/*
* Kendo UI Web v2012.3.1114 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Web commercial licenses may be obtained at
* https://www.kendoui.com/purchase/license-agreement/kendo-ui-web-commercial.aspx
* If you do not own a commercial license, this file shall be governed by the
* GNU General Public License (GPL) version 3.
* For GPL requirements, please review: http://www.gnu.org/copyleft/gpl.html
*/
(function(e,t){var n=window.kendo,a=n.ui,s=a.List,o=a.Select,i=n.support,r=i.placeholder,l=o.removeFiltersForField,c=n.keys,u=".kendoComboBox",d="touchend"+u+" click"+u,p="disabled",_="change",h="k-state-default",f="k-state-disabled",g="k-state-focused",v="mousedown"+u+" touchstart"+u,x="select",m="aria-disabled",C="k-state-selected",y="filter",w="accept",b="rebind",k="mouseenter"+u+" mouseleave"+u,L=null,I=e.proxy,T=o.extend({init:function(t,a){var s,i,r=this;r.ns=u,a=e.isArray(a)?{dataSource:a}:a,o.fn.init.call(r,t,a),r._focusHandler=function(){r.input.focus()},a=r.options,t=r.element.on("focus"+u,r._focusHandler),a.placeholder=a.placeholder||t.attr("placeholder"),r._reset(),r._wrapper(),r._input(),r._popup(),r._accessors(),r._dataSource(),r._enable(),r._cascade(),s=r._inputWrapper,r.input.on("keydown"+u,I(r._keydown,r)).on("focus"+u,function(){s.addClass(g),r._placeholder(!1)}).on("blur"+u,function(){s.removeClass(g),clearTimeout(r._typing),r.options.text!==r.input.val()&&r.text(r.text()),r._placeholder(),r._blur(),t.blur()}).attr({role:"combobox","aria-expanded":!1}),r._aria(),r._oldIndex=r.selectedIndex=-1,r._old=r.value(),a.autoBind?r._filterSource():(i=a.text,!i&&t.is(x)&&(i=t.children(":selected").text()),i&&r.input.val(i)),i||r._placeholder(),n.notify(r)},options:{name:"ComboBox",enable:!0,index:-1,autoBind:!0,delay:200,dataTextField:"",dataValueField:"",minLength:0,height:200,highlightFirst:!0,template:"",filter:"none",placeholder:"",suggest:!1,ignoreCase:!0,animation:{}},events:["open","close",_,"select","dataBinding","dataBound"],setOptions:function(e){o.fn.setOptions.call(this,e),this._template(),this._accessors(),this._aria()},current:function(e){var n=this,a=n._current;return e===t?a:(a&&a.removeClass(C),o.fn.current.call(n,e),t)},destroy:function(){var e=this;e.input.off(u),e.element.off(u),e._inputWrapper.off(u),o.fn.destroy.call(e)},enable:function(e){var t=this,n=t.input.add(t.element),a=t._inputWrapper.off(k),s=t._arrow.parent().off(d+" "+v);e===!1?(a.removeClass(h).addClass(f),n.attr(p,p).attr(m,!0)):(a.removeClass(f).addClass(h).on(k,t._toggleHover),n.removeAttr(p).attr(m,!1),s.on(d,function(){t.toggle()}).on(v,function(e){e.preventDefault()}))},open:function(){var e=this,t=e.dataSource.options.serverFiltering;e.popup.visible()||(!e.ul[0].firstChild||e._state===w&&!t?(e._open=!0,e._state=b,e._filterSource()):(e.popup.open(),e._scroll(e._current)))},refresh:function(){var a,s,o,i=this,r=i.ul[0],l=i.options,c=i._state,u=i._data(),d=u.length;i.trigger("dataBinding"),r.innerHTML=n.render(i.template,u),i._height(d),i.popup.visible()&&i.popup._position(),i.element.is(x)&&(c===b&&(a=i.value(),i._state=""),o=i._option,i._option=t,i._options(u),o&&o[0].selected&&i._custom(o.val())),d&&(l.highlightFirst&&i.current(e(r.firstChild)),l.suggest&&i.input.val()&&i._valueCalled!==t&&i.suggest(e(r.firstChild))),i._open&&(i._open=!1,s=!!d,i._typing&&i.input[0]!==document.activeElement&&(s=!1),i.toggle(s),i._typing=t),i._touchScroller&&i._touchScroller.reset(),i._makeUnselectable(),(!i._valueCalled&&c!==y||c===b)&&i._selectItem(a),i._valueCalled=!1,i._hideBusy(),i.trigger("dataBound")},select:function(e){var n=this;return e===t?n.selectedIndex:(n._select(e),n._old=n._accessor(),n._oldIndex=n.selectedIndex,t)},search:function(e){e="string"==typeof e?e:this.text();var t=this,n=e.length,a=t.options,s=a.ignoreCase,o=a.filter,i=a.dataTextField;clearTimeout(t._typing),n>=a.minLength&&(t._state=y,"none"===o?t._filter(e):(t._open=!0,t._filterSource({value:s?e.toLowerCase():e,field:i,operator:o,ignoreCase:s})))},suggest:function(e){var n,a=this,o=a.input[0],i=a.text(),r=s.caret(o),l=a._last;return l==c.BACKSPACE||l==c.DELETE?(a._last=t,t):(e=e||"","string"!=typeof e&&(n=s.inArray(e[0],a.ul[0]),e=n>-1?a._text(a.dataSource.view()[n]):""),0>=r&&(r=i.toLowerCase().indexOf(e.toLowerCase())+1),e?(n=e.toLowerCase().indexOf(i.toLowerCase()),n>-1&&(i+=e.substring(n+i.length))):i=i.substring(0,r),i.length===r&&e||(o.value=i,s.selectText(o,r,i.length)),t)},text:function(e){e=null===e?"":e;var n,a=this,s=a._text,o=a.input[0],i=a.options.ignoreCase,r=e;return e===t?o.value:(n=a.dataItem(),n&&s(n)===e||(i&&(r=r.toLowerCase()),a._select(function(e){return e=s(e),i&&(e=(e+"").toLowerCase()),e===r}),0>a.selectedIndex&&(a._custom(e),o.value=e)),t)},toggle:function(e){var t=this;t._toggle(e)},value:function(e){var n,a=this;return e===t?a._accessor():(null!==e&&(e=""+e),a._valueCalled=!0,e&&a._valueOnFetch(e)||(n=a._index(e),n>-1?a.select(n):(a.current(L),a._custom(e),a.text(e),a._placeholder()),a._old=a._accessor(),a._oldIndex=a.selectedIndex),t)},_accept:function(e){var t=this;e&&t.popup.visible()?t._focus(e):(t.text(t.text()),t._change())},_custom:function(t){var n=this,a=n.element,s=n._option;n._state===y&&(n._state=w),a.is(x)?(s||(s=n._option=e("<option/>"),a.append(s)),s.text(t),s[0].selected=!0):a.val(t)},_filter:function(e){var n=this,a=n.options,s=n.dataSource,o=a.ignoreCase,i=function(a){var s=n._text(a);return s!==t?(s+="",""!==s&&""===e?!1:(o&&(s=s.toLowerCase()),0===s.indexOf(e))):t};return o&&(e=e.toLowerCase()),n.ul[0].firstChild?(-1!==n._highlight(i)&&(a.suggest&&n._current&&n.suggest(n._current),n.open()),n._hideBusy(),t):(s.one(_,function(){s.data()[0]&&n.search(e)}).fetch(),t)},_highlight:function(n){var a,o=this;return n===t||null===n?-1:(n=o._get(n),a=s.inArray(n[0],o.ul[0]),-1==a&&(n=o.options.highlightFirst&&!o.text()?e(o.ul[0].firstChild):L),o.current(n),a)},_input:function(){var t,n,a=this,s=a.element.removeClass("k-input")[0],o=s.tabIndex,i=s.accessKey,l=a.wrapper,c="input.k-input",u=s.name||"";u&&(u='name="'+u+'_input" '),t=l.find(c),t[0]||(l.append('<span tabindex="-1" unselectable="on" class="k-dropdown-wrap k-state-default"><input '+u+'class="k-input" type="text" autocomplete="off"/><span tabindex="-1" unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(a.element),t=l.find(c)),n=t[0],n.tabIndex=o,n.style.cssText=s.style.cssText,s.maxLength>-1&&(n.maxLength=s.maxLength),t.addClass(s.className).val(s.value).css({width:"100%",height:s.style.height}).show(),r&&t.attr("placeholder",a.options.placeholder),i&&(s.accessKey="",t[0].accessKey=i),a._focused=a.input=t,a._inputWrapper=e(l[0].firstChild),a._arrow=l.find(".k-icon").attr({role:"button",tabIndex:-1}),s.id&&a._arrow.attr("aria-controls",a.ul[0].id)},_keydown:function(e){var t=this,n=e.keyCode;t._last=n,clearTimeout(t._typing),n==c.TAB||t._move(e)||t._search()},_placeholder:function(e){if(!r){var n,a=this,s=a.input,o=a.options.placeholder;if(o){if(n=a.value(),e===t&&(e=!n),s.toggleClass("k-readonly",e),!e){if(n)return;o=""}s.val(o)}}},_search:function(){var e=this;e._typing=setTimeout(function(){var t=e.text();e._prev!==t&&(e._prev=t,e.search(t))},e.options.delay)},_select:function(e){var n,a,s=this,o=s._data(),i=s._highlight(e);s.selectedIndex=i,-1!==i&&(s._state===y&&(s._state=w),s._current.addClass(C),o=o[i],n=s._text(o),a=s._value(o),s._prev=s.input[0].value=n,s._accessor(a!==t?a:n,i),s._placeholder(),s._optionID&&s._current.attr("aria-selected",!0))},_filterSource:function(e){var t=this,n=t.options,a=t.dataSource,s=a.filter()||{};l(s,n.dataTextField),e&&(s=s.filters||[],s.push(e)),a.filter(s)},_wrapper:function(){var e=this,t=e.element,n=t.parent();n.is("span.k-widget")||(n=t.hide().wrap("<span />").parent(),n[0].style.cssText=t[0].style.cssText),e.wrapper=n.addClass("k-widget k-combobox k-header").addClass(t[0].className).css("display","")}});a.plugin(T)})(window.kendo.jQuery);